typeof JSON!="object"&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e,t,n){function i(e){return e}function s(e){return decodeURIComponent(e.replace(r," "))}var r=/\+/g,o=e.cookie=function(r,u,a){if(u!==n){a=e.extend({},o.defaults,a),u===null&&(a.expires=-1);if(typeof a.expires=="number"){var f=a.expires,l=a.expires=new Date;l.setDate(l.getDate()+f)}u=o.json?JSON.stringify(u):String(u);var c=[encodeURIComponent(r),"=",o.raw?u:encodeURIComponent(u),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("");return t.cookie=c,c}var h=o.raw?i:s,p=t.cookie.split("; ");for(var d=0,v=p.length;d<v;d++){var m=p[d].split("=");if(h(m.shift())===r){var g=h(m.join("="));return o.json?JSON.parse(g):g}}return null};o.defaults={},e.removeCookie=function(t,n){return e.cookie(t)!==null?(e.cookie(t,null,n),!0):!1}}(jQuery,document);var initPlugin,__slice=[].slice;initPlugin=function(e){var t,n,r,i,s,o=this;return e.mynaDefaults={apiRoot:"http://api.mynaweb.com",sticky:!0,cookieName:"myna",cookieOptions:{expires:7}},e.mynaLog=function(){var e;return e=1<=arguments.length?__slice.call(arguments,0):[],typeof console!="undefined"&&console!==null?typeof console.log=="function"?console.log(e):void 0:void 0},e.mynaError=function(){var t;throw t=1<=arguments.length?__slice.call(arguments,0):[],e.mynaLog.apply(e,t),t},e.mynaSuggestions={},r=function(){var t;e.mynaLog("loadSuggestions"),t=e.mynaDefaults.cookieName,e.mynaLog(" - ",t);try{return JSON.parse(e.cookie(t))||{}}catch(n){return{}}},i=function(t){var n,r,i;e.mynaLog("saveSuggestions",t),n=e.mynaDefaults.cookieName,i=JSON.stringify(t),r=e.mynaDefaults.cookieOptions,e.mynaLog(" - ",n,i,r),e.cookie(n,i),e.mynaLog(" - ",document.cookie)},e.mynaSaveSuggestion=function(t,n,s,o){var u;o==null&&(o=!1),e.mynaLog("mynaSaveSuggestion",t,n,s,o),u=r(),u[t]={choice:n,token:s,rewarded:o},i(u)},e.mynaDeleteSuggestion=function(t){var n;e.mynaLog("mynaDeleteSuggestion",t),n=r(),delete n[t],i(n)},e.mynaLoadSuggestion=function(t){return e.mynaLog("mynaLoadSuggestion",t),r()[t]||null},e.mynaSuggest=function(t){var n,r,i,s;t=e.extend({},e.mynaDefaults,t),r=t.success||function(){},n=t.error||function(){},s=t.uuid||e.mynaError("mynaSuggest: no uuid"),i=""+t.apiRoot+"/v1/experiment/"+s+"/suggest",e.ajax({url:i,dataType:"jsonp",crossDomain:!0,success:function(t,i,o){t.typename==="suggestion"?(e.mynaSaveSuggestion(s,t.choice,t.token),r({uuid:s,choice:t.choice,token:t.token})):(e.mynaLog("mynaSuggest received "+t.typename,t,i,o),n(t,i,o))},error:function(t,r,i){e.mynaLog("mynaSuggest received error",t,r,i),n({},r,t,i)}})},e.mynaReward=function(t){var n,r,i,s,o,u,a,f;t=e.extend({},e.mynaDefaults,t),o=t.success||function(){},i=t.error||function(){},f=t.uuid||e.mynaError("mynaReward: no uuid"),s=e.mynaLoadSuggestion(f),s&&!s.rewarded?(u=s.token,r=s.choice,e.mynaSaveSuggestion(f,r,u,!0),n=t.amount||1,a=""+t.apiRoot+"/v1/experiment/"+f+"/reward?token="+u+"&amount="+n,e.ajax({url:a,dataType:"jsonp",crossDomain:!0,success:function(t,i,s){t.typename==="ok"?(e.mynaLog("mynaReward received ok",t,i,s),e.mynaSaveSuggestion(f,r,u,!0),o({uuid:f,choice:r,token:u,amount:n})):e.mynaLog("mynaReward received "+t.typename,t,i,s)},error:function(t,n,r){e.mynaLog("mynaReward received error",t,n,r),e.mynaDeleteSuggestion(f),i({},n,t,r)}})):o()},e.fn.mynaDefaultAction=function(){var t;t=e(this);if(t.is("a"))return window.location=t.attr("href")},e.mynaWrapHandler=function(t,n){return e.mynaLog("wrapHandler",t,n),function(r){var i;e.mynaLog("wrappedHandler",r),i=e.mynaLoadSuggestion(t),i&&!i.rewarded?(e.mynaLog(" - rewarding and retriggering"),r.stopPropagation(),r.preventDefault(),e.mynaReward({uuid:t,success:function(){return e(r.target).trigger(r.type)},error:function(){return e(r.target).trigger(r.type)}})):(e.mynaLog(" - retriggering"),n(r),e(r.target).mynaDefaultAction())}},e.fn.mynaClick=function(){var t,n,r,i;i=arguments[0],t=2<=arguments.length?__slice.call(arguments,1):[],e.mynaLog.apply(e,["mynaClick",i].concat(__slice.call(t)));switch(t.length){case 0:return this.click(e.mynaWrapHandler(i,function(){}));case 1:return r=t[0],this.click(e.mynaWrapHandler(i,r));default:return n=t[0],r=t[1],this.click(n,e.mynaWrapHandler(i,r))}},t=function(t,n){return e("."+t).each(function(t,r){var i,s,o;return s=e(r),o=s.data("variant"),i=s.data("goal"),n.call(s,o,i)})},s=function(e,n){return n==null&&(n=null),t(e,function(e,t){if(e)return n&&e===n?this.show():this.hide()})},n=function(e,n){return t(n,function(t,n){switch(n){case"click":return this.mynaClick(e)}})},e.mynaInit=function(t){var r,i,o,u;u=t.uuid,r=t["class"],i=t.sticky;if(!u||!r){e.mynaLog("mynaInit: no uuid or CSS class",u,r);return}o=e.mynaLoadSuggestion(u),e.mynaLog("mynaInit",u,r,i,o),o&&(i||!o.rewarded)?(e.mynaLog(" - recalling suggestion",o.choice),s(r,o.choice),n(u,r)):(e.mynaLog(" - fetching suggestion"),e.mynaSuggest({uuid:u,success:function(e){s(r,e.choice),n(u,r)},error:function(){showDefaultVariant(r)}}))},e.myna=function(t){return t=e.extend({},e.mynaDefaults,t),e.mynaLog("myna",t),e.each(t.experiments,function(n,r){return r=e.extend({sticky:t.sticky},r),e.mynaInit(r)})}},initPlugin(window.jQuery,window,document);